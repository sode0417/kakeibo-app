# 家計簿アプリ改善計画

## プロジェクトのアーキテクチャ

*   **フロントエンド:** React + TypeScript + Vite
*   **バックエンド:** .NET + SQLite
*   **データ永続化:** SQLite (ローカル)
*   **デプロイ:** Netlify (フロントエンド), AWS Lambda (バックエンド)
*   **目的:** 個人の日々の支出管理
*   **ターゲットユーザー:** 個人

## 現状の改善点

1.  **データ永続化:** 現在、データはメモリ内に保存されており、アプリケーション再起動時に消失します。Issue 003 と 005 に関連します。
2.  **CI/CD パイプライン:** CI/CD パイプラインが構築されておらず、開発プロセスの効率化と品質向上が求められます。Issue 004 に関連します。
3.  **エラーハンドリング:** フロントエンドとバックエンドでエラーハンドリングが不十分です。Issue 001 と 002 に関連します。
4.  **CORS 設定:** `AllowAnyOrigin` を使用しており、セキュリティリスクがあります。Issue 002 に関連します。
5.  **コードの再利用性:** バックエンドでコードの再利用性が低い箇所があります。Issue 002 に関連します。
6.  **UI のアクセシビリティ:** タブ切り替えの視覚的フィードバックが不足しています。Issue 001 に関連します。
7.  **型の明確化:** `Record` 型の `category` プロパティが仮の値であり、型の整合性が不足しています。Issue 001 に関連します。

## 改善計画

1.  **データ永続化の実現 (Issue 003, 005):**
    *   SQLite データベースを導入し、データの永続化を実現します。
    *   Entity Framework Core を使用してデータベース操作を簡略化します。
    *   `Record` と `Category` のモデルをデータベーステーブルにマッピングします。
    *   エンドポイントを更新し、データベース操作を使用するようにします。
    *   マイグレーションを作成し、データベースを初期化します。
2.  **CI/CD パイプラインの構築 (Issue 004):**
    *   GitHub Actions を使用して CI/CD パイプラインを構築します。
    *   プルリクエスト時に自動テストを実行します。
    *   Linter（ESLint, .NET Analyzer）を使用したコード品質チェックを行います。
    *   メインブランチへのマージ後、自動的にアプリケーションを Netlify (フロントエンド) と AWS Lambda (バックエンド) にデプロイします。
    *   機密情報（API キー、データベース接続文字列など）を GitHub Secrets を使用して安全に管理します。
3.  **エラーハンドリングの強化 (Issue 001, 002):**
    *   フロントエンドで Snackbar コンポーネントを利用して、エラー発生時にユーザー通知を追加します。
    *   バックエンドでエラーメッセージを含む詳細なレスポンスを返すように変更します。
4.  **CORS 設定の見直し (Issue 002):**
    *   開発環境と本番環境で異なる CORS 設定を適用します。
5.  **コードの再利用性向上 (Issue 002):**
    *   バックエンドで共通処理をヘルパーメソッドとして切り出し、コードの再利用性を向上させます。
6.  **UI のアクセシビリティ向上 (Issue 001):**
    *   タブ切り替えの視覚的フィードバックを改善します。
7.  **型の明確化 (Issue 001):**
    *   `Record` 型の `category` プロパティを修正します。

## 改善計画の Mermaid ダイアグラム

```mermaid
graph LR
    A[現状のアーキテクチャ] --> B(データ永続化);
    A --> C(CI/CD パイプライン);
    A --> D(エラーハンドリング);
    A --> E(CORS 設定);
    A --> F(コードの再利用性);
    A --> G(UI のアクセシビリティ);
    A --> H(型の明確化);

    B --> B1[SQLite データベース導入];
    B --> B2[Entity Framework Core 導入];
    B --> B3[モデルのマッピング];
    B --> B4[エンドポイントの更新];
    B --> B5[マイグレーションの実行];

    C --> C1[GitHub Actions 設定];
    C --> C2[自動テストの実行];
    C --> C3[Linter の実行];
    C --> C4[Netlify/AWS Lambda へのデプロイ];
    C --> C5[GitHub Secrets による環境変数管理];

    D --> D1[Snackbar コンポーネントの追加 (フロントエンド)];
    D --> D2[詳細なエラーレスポンス (バックエンド)];

    E --> E1[開発/本番環境別の CORS 設定];

    F --> F1[ヘルパーメソッドの切り出し];

    G --> G1[タブ切り替えの視覚的フィードバック改善];

    H --> H1[Record 型の category プロパティ修正];